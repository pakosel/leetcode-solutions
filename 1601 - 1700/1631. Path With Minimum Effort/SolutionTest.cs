using System.Text;
using NUnit.Framework;
using NUnit.Framework.Legacy;
using System.Linq;
using System.Collections.Generic;
using Common;

namespace PathWithMinimumEffort
{
    [TestFixture]
    public class SolutionTest
    {
        private static readonly object[] testCasesStr =
        {
            new object[] {"[[1,2,2],[3,8,2],[5,3,5]]", 2},
            new object[] {"[[1,2,3],[3,8,4],[5,3,5]]", 1},
            new object[] {"[[1,2,1,1,1],[1,2,1,2,1],[1,2,1,2,1],[1,2,1,2,1],[1,1,1,2,1]]", 0},
            new object[] {"[[3]]", 0},
            new object[] {"[[3],[2],[1]]", 1},
            new object[] {"[[1,2,3]]", 1},
            new object[] {"[[736692,109940,683627,107611,91524,153314,715639,690231,943985,490130,229519,506425,770358,15907,684061,300161,654563,49771,121728,709266,744358,142578,497872,583567,301290,542317,947379,485895,719909,149221,901598,918861,528220,924522,711358,272598,623710,998102],[522532,102480,87283,492799,470195,754330,169407,902429,952870,777853,620910,308098,958814,28271,95787,160306,232116,172082,301054,513549,557256,532146,952938,64059,98009,386724,34767,758847,658215,934094,251493,575360,774610,924647,78045,828394,417244,661769],[803046,705175,372701,256226,770059,492168,311730,259262,174895,260698,574715,329349,978436,721235,767834,366411,87088,536428,741230,549615,589217,382222,70584,524775,616450,229478,613104,414735,55693,252724,543178,285022,11779,952873,145998,97794,282625,162168],[205197,489273,363617,824112,684104,614375,291237,963359,563244,868995,94808,62247,142661,687136,77686,831304,805373,200174,730010,232535,155358,886726,170468,252122,45557,265910,34362,904054,963103,977526,124006,212460,402865,788079,885019,757936,525337,280370],[503088,89979,193833,769594,487378,931651,149602,179453,244714,602598,190346,759203,110767,751488,957840,42945,454825,983332,769960,102549,696229,916589,1475,225483,44841,564741,128365,458452,883375,689628,208554,481042,283397,475123,349008,499278,456611,760901],[291185,846574,742933,620962,246421,800432,846869,534619,314241,921634,175882,784699,631327,140566,686977,320606,429533,428973,808707,972895,124799,279146,180431,938459,926802,931497,831900,299817,376350,74627,402677,212650,480246,26708,207953,961111,10792,732013],[981079,701099,733467,167659,291335,632110,993338,888576,261028,519761,338349,612905,216018,738386,465898,754052,539837,486279,974805,533544,253594,491077,685486,765055,555885,939247,286033,838164,663359,269435,864866,526251,57605,304934,753991,851505,617836,691412],[941758,461283,654039,134353,753274,843862,814956,868076,437109,671410,115792,848361,60679,140524,194415,703698,726769,144330,286403,806772,714126,861176,658954,520807,779817,348877,743081,110776,314711,223969,190807,238813,501759,16868,405763,404238,776113,362309],[132703,840740,366917,109289,578633,120416,167110,640603,630924,789075,528283,7308,474480,952450,515201,954271,838658,310657,141959,690815,125822,664580,172221,50539,617871,14195,10268,538760,209228,603499,115375,62408,781611,250388,62592,326418,717299,282046],[230457,425791,416089,907538,411774,831315,647125,183646,391001,714791,125803,44811,34485,205468,30225,444005,750021,254736,718937,152694,510457,708453,784065,671079,834382,758158,379244,12311,91548,850519,83202,908725,22884,22377,458840,82478,179209,706863],[120956,616291,538442,678279,167387,658493,120840,843375,141828,995707,135815,327129,946240,462557,485975,409290,622800,247812,851211,275901,169649,247163,766562,218088,252210,152996,330887,347510,469965,599124,344344,624155,624216,270397,989098,547479,832785,944287],[594728,271500,402195,109937,735011,354761,139908,833257,761441,413222,65053,771913,12325,480993,689627,245753,115181,497496,258493,337025,292416,930091,400918,326095,530824,209573,952522,729076,22660,602368,912694,195553,125057,608605,422321,921461,569899,414699],[690780,597416,446024,202398,373470,443218,124378,179457,620109,967896,619064,507410,545724,379905,608781,105561,101310,705953,180571,294524,599070,916742,644279,516442,473784,274783,830967,545778,632474,449439,144635,599079,471921,501732,903856,436323,321588,218719],[71667,157171,583169,959002,850252,105907,503957,482637,719089,532044,712136,385041,804451,62533,841523,930396,501317,341500,863493,329120,871446,179950,518509,18288,302865,137959,954784,575188,619799,869795,321390,511411,3523,604390,685314,944799,296080,295569],[752805,121077,133379,861531,428233,562050,998717,152548,100349,231648,590446,172227,762152,681112,535223,207172,803322,147061,341372,279414,497745,183958,157810,543685,904127,256661,435577,999201,405826,139162,145638,308982,759281,427916,46069,88775,659091,35299],[360653,154604,558441,180975,74097,505019,533905,847024,481136,362742,42297,829680,533092,137639,506057,980986,757461,791288,238698,702634,476278,948697,531121,607143,258921,72935,841126,38113,335610,741969,386167,590206,426800,627086,423047,528735,98818,244301],[631232,335920,698563,735655,306553,208840,593160,254128,305477,234026,376828,770376,33647,789910,447999,311821,543202,340893,758104,122325,332974,620844,331806,846114,297789,450162,510262,844814,48773,114008,640038,660943,245154,867060,664137,974658,632390,20209],[221165,846367,953298,598799,379301,620000,53935,70598,128015,869390,60764,34289,171687,518794,97285,88326,482317,40857,442939,782763,163596,856447,804661,557322,559845,392831,762982,879390,70196,557098,792157,55758,202632,504315,167232,165784,442835,317503],[39734,152525,23186,47198,526087,62264,256902,735586,850695,143257,890295,436868,932200,536745,836528,476935,934295,963152,235164,207839,16415,593584,464608,89000,340196,32992,359492,730411,612002,172685,7828,568764,753927,457688,181122,306705,859546,781389],[73652,167662,861774,475880,190482,484096,984415,337130,590934,986118,999384,175034,970389,485594,695817,68312,870991,889780,721722,287805,929840,814615,126110,50291,249608,137726,753359,808433,648094,810636,25792,295271,565007,602737,145555,461897,2176,917761],[591765,463630,389376,967341,400115,660772,37711,192812,821819,620301,776340,650692,948571,987300,621333,523494,512777,990478,927213,622423,397645,908250,646035,533087,39050,323146,381455,502734,398772,462250,347063,211815,376984,379342,526198,629807,923364,272962],[155225,234131,78822,728112,872637,803019,124386,507621,492588,891207,557792,358882,929985,501573,339411,708344,456083,991091,660394,290752,85824,623815,282745,756626,721555,985675,35150,86671,123978,624294,907599,361107,374049,954335,901322,223694,292172,367253],[679956,80126,70860,430205,679798,520219,397075,818862,123019,768257,446900,324680,70249,219225,669847,315706,702656,525476,283445,407473,646668,719541,43348,520351,958319,565913,590867,728077,814470,51012,595424,779027,500756,330939,781011,313946,690710,439340],[925604,518373,11009,425900,557755,800087,13964,371978,702552,962999,124849,205113,240607,788516,233231,191379,786126,448716,72040,514884,493968,721026,839932,865940,274651,8079,792208,37138,444292,893551,598606,351953,462250,704321,186709,833388,171158,659154],[582813,860193,535722,201741,968720,355248,248549,346387,608629,657672,917288,134429,6380,38424,562889,433479,426829,880321,600855,937719,330874,946142,247711,726721,713610,863349,580611,575904,516212,206753,563376,375476,118778,542348,69769,40664,841710,673910],[892765,704850,581929,577536,834254,613899,681456,356219,449620,491613,348091,623057,141169,625509,214480,536669,922454,383113,410174,309305,564465,899276,970552,409457,676592,986383,828626,690829,951588,37137,884020,41561,990810,726072,363630,691306,341579,984801],[139420,937524,560804,287973,719544,358477,811965,285552,212262,496929,479939,740644,27994,877579,852380,11586,502400,52846,100621,73513,989017,10979,388623,41569,574362,696813,166164,864730,682615,522979,632712,333433,458473,817830,179265,500019,289945,983703],[725037,244087,351701,253586,3581,840548,499018,919101,919321,279594,601179,444670,374897,241248,973568,836189,233686,460603,157609,355717,985896,851224,285830,716673,879471,991552,207297,117742,807002,796747,431412,111031,444504,362256,26410,563256,598025,610837],[265176,353164,903640,776041,454801,547910,763371,468232,777700,16807,521301,709462,402499,759818,241438,466996,593587,651166,114751,999709,782497,327336,400301,210412,259164,445780,468667,221896,236560,256459,523054,917790,846392,471768,153912,595402,993613,386419],[944742,690776,261461,98113,433087,93942,619942,186387,245909,589950,717863,422169,812342,64472,646662,158534,859696,153647,748458,886143,758092,21371,989377,54841,2789,747939,751539,91684,883349,225962,299965,210256,387314,578474,464363,211964,767864,348585],[928923,853337,333783,460591,70212,599586,282222,826286,425511,751931,974805,854092,236486,743673,310655,617423,843126,964456,914640,672049,239138,34076,126001,627684,425506,797824,986726,490305,843534,340687,786598,360706,361086,111949,700766,202463,440118,714324],[933944,310387,293014,4246,3729,740840,808792,928136,2841,865378,889827,108105,203917,694527,485,435620,632102,956006,290941,567924,691859,350172,930920,80540,199299,83416,25757,525089,274773,62371,237972,156454,66332,350042,836923,385198,642721,317598],[541928,811134,51978,369671,505451,491865,862092,616312,196750,921772,868127,544641,329678,216255,427502,779918,685996,154402,455536,216383,365045,85834,921756,477833,54919,393375,976251,599728,385808,547318,90492,43169,643136,510847,380840,155017,678616,363746],[255948,764783,367525,665902,506073,494316,378407,698402,45423,233093,985952,582073,470807,731875,186014,149635,91650,354324,904375,368277,223802,325880,655476,793151,179945,780307,763742,427095,844626,773332,44632,57343,965070,216095,244616,978217,659759,868153],[384589,926142,800286,830242,422774,223006,536412,343898,823810,668018,863806,689406,950079,888618,132053,123428,418487,81927,457544,580136,344453,340558,217033,596004,934505,158511,44784,377225,929956,472894,763969,747358,738406,707034,928624,421845,158785,207415],[831703,243099,207320,230191,786959,647562,889020,998583,260107,546606,105117,647276,764967,241916,614139,461207,678142,860464,160646,600896,110690,369562,212600,11429,148181,699739,627948,880995,500028,947022,253030,920163,338313,881899,389242,743992,573620,481446],[873581,601684,944825,929644,522526,195004,588325,112903,163405,244024,802676,143058,684452,291782,960608,641549,724921,150700,263469,349240,888769,154358,955204,490490,732014,553778,158171,512219,595513,781488,965208,587290,86564,619986,170208,678582,838206,938502],[555638,584725,561201,21532,107889,584054,968866,546673,497163,346844,219641,24248,674418,201844,597362,39456,965900,302653,552601,433200,405681,961573,227728,574598,411238,262230,693569,170738,335355,483623,969197,629191,142135,370001,310286,41615,644021,813512],[712899,15304,300121,960399,603722,677975,416262,326422,391576,358970,736871,277671,796746,67277,334826,727145,933810,22074,829606,684595,308625,685379,145226,511398,261625,59198,345691,343972,297277,978881,652529,531760,355509,203416,709427,544327,632985,907179],[235947,515899,120911,820634,743631,440576,183630,115956,292575,851402,147555,247908,268327,271972,759427,607330,617177,729143,743850,336325,395813,765822,620329,411024,357034,772758,422093,141815,672532,424128,208059,317295,238557,867980,169404,926261,986989,933230],[405334,196635,298794,944275,526257,939588,959628,288981,12350,832560,152470,435802,793527,511511,470310,714817,209852,806472,143021,418420,869972,490609,93396,504203,214719,587495,663556,62807,336941,975508,558935,612219,867515,502907,396572,471415,739560,377080],[707385,987371,386694,363216,987087,869339,792999,493972,765436,559213,594848,910272,122974,937663,355120,258805,377283,365333,742912,763394,771584,337559,305465,897045,378719,696321,545448,234361,364768,157856,595405,428476,377156,823275,13445,368325,551234,431654],[747066,576478,177312,838045,535401,557093,450180,789368,501937,298925,303286,589605,118783,458560,481138,381768,599656,930000,263686,930085,587455,477762,743692,925498,925410,876695,81111,902439,433514,340637,490790,499963,788279,196556,315180,846012,772784,959584],[145047,244361,587813,941158,960682,24196,195684,73964,318223,829592,48623,535308,15367,975876,859385,345451,522314,137161,33597,660813,348622,704860,561350,970693,82189,353515,878949,872260,782912,844127,189158,977113,477777,811769,120535,503543,1171,895365],[663589,763819,248182,626501,168757,849848,192766,785898,292628,842268,366835,150890,49734,543096,478698,144474,901020,44501,589967,939240,480129,200915,58392,795339,987387,33010,935588,957140,328895,154151,214184,196085,268991,903720,763861,362193,365133,857288],[521655,497673,791557,859495,756943,221093,755455,373623,889471,329772,868881,583993,102373,178561,192748,2537,968653,418145,211485,230489,606887,714287,690579,290195,46362,538974,355593,671986,590121,589487,340338,491703,194084,995246,891844,343894,380113,363099],[647879,338613,44784,489004,298509,904408,171641,103851,411945,296535,842120,505123,154078,182656,74477,414189,450143,34192,785064,746534,59012,369748,172073,408398,932961,582863,404841,851526,998698,252413,930725,852767,430553,236520,51164,181565,188229,474457],[588345,272213,826110,908887,551372,40578,261633,466093,140688,584776,898111,213659,143567,158243,521291,521020,18651,298263,481707,704666,7148,217997,548205,794844,815472,197029,42008,47279,386842,901730,127318,20182,564759,843764,802726,601659,223384,348983],[87892,212917,274616,427772,184356,900187,973978,796882,601300,477907,623910,327130,929098,392568,933698,760200,377641,953599,558067,495811,592996,80822,688277,899896,34344,549544,458151,810754,665707,859550,62017,680886,607219,938572,986564,921115,719103,886997],[521076,239877,988724,182149,921016,44567,61721,35324,643672,708616,925764,447938,735531,207982,936108,869603,487042,529343,874652,167712,356445,390031,84930,807895,689622,653991,627991,697489,962048,61414,274289,627451,772902,311979,288003,626095,13939,665713],[909173,541013,543785,423708,914222,522692,997956,924555,548950,235410,477186,74633,331261,635726,575984,101926,267668,356849,74768,520120,961740,418449,39574,431410,190859,770929,67036,707824,652547,829623,862636,550495,768692,945492,551762,373046,595504,297095],[260996,239221,144387,952406,100610,989571,838115,817323,666251,958796,812689,984177,724810,713611,94481,254342,12544,816025,315364,671814,642211,87440,302651,960345,82256,899484,840867,871157,590943,624825,335050,558427,410028,443079,770104,714983,867526,459806],[314178,22182,808825,281044,206104,895702,205902,985732,363123,82465,241746,27287,31575,556505,888593,796505,547499,523535,522461,743294,884224,192894,334158,384826,813403,754315,449210,751171,258945,798892,646266,372831,645198,101526,586595,407778,492146,196571],[376405,771138,722220,650621,516889,711348,741994,964790,743824,427862,77599,860922,734167,755042,296140,241605,187473,879850,579707,79536,835807,235261,842159,406137,389549,889131,330801,947155,561857,96525,823795,602347,774299,628323,842684,105700,244932,185792],[182905,165636,48740,661598,417990,30323,809352,511797,525696,187189,539247,764101,404504,675955,808081,594098,332133,537297,580523,472805,957080,532362,990161,633079,631435,596037,395988,407612,712878,122633,840561,492471,537691,21528,228368,73634,994288,444395],[107343,436387,6226,761454,570163,218883,32419,241253,82522,34954,851098,974698,565809,494922,240456,442172,688184,55983,814712,671500,49037,430666,894098,565074,199890,791898,127068,826921,928471,174052,503897,875275,174911,984122,464131,863543,884226,493564],[301331,220049,390522,740918,302265,800747,308998,906577,963923,566240,34270,504798,961804,333869,565269,464408,75506,248051,462282,496716,816375,188747,67223,117222,540745,735655,578319,202017,181699,38170,372868,448400,267607,22153,783502,738037,185182,427890],[568944,86396,568559,72753,715676,838051,231701,863750,155574,919294,976384,73066,548664,160614,188403,989490,691428,471544,906031,637807,470170,651325,479430,765457,988653,863657,102878,532802,538332,26908,950912,375349,657105,8520,280445,605429,547752,886123],[108753,58545,802335,385709,27880,89175,989225,404683,637934,632920,714898,470743,452685,180780,78832,683513,431480,842111,512435,375327,557760,99259,447265,282281,565081,21416,924477,278494,155929,870869,970309,807558,665253,278355,615312,122211,708915,886576],[119377,767325,261160,783707,723914,303543,928338,500782,160096,737950,891271,78126,488520,530314,296004,308416,955689,323581,524338,198900,732746,322845,520590,727916,3950,641953,869448,646134,194306,877469,166665,43437,171736,208535,686957,768985,498315,666168],[950632,486738,912672,547106,792500,325299,411522,28375,874226,741478,160680,288846,94166,413857,231814,398027,714434,310036,934240,651372,646546,241065,396850,921310,464265,70866,578162,751305,176579,746885,359659,121855,447239,513226,413019,775999,823598,241547],[338179,439453,994615,53735,922832,290687,901644,352687,697093,48589,86415,30821,604291,73312,278174,529751,527780,855425,133681,285074,565774,26140,393185,26437,912658,295195,967296,256789,296845,131393,981196,135660,779002,323726,847997,433061,103337,229902],[712305,396008,536,699385,896239,181368,825077,977865,857234,476541,249278,821607,674205,791772,257854,560702,133571,787883,235063,628275,803971,603515,676446,32587,629914,852523,742825,617549,439068,35835,671652,641095,411309,950666,357113,578127,391039,329556],[523948,423363,278083,117584,321129,286171,190342,451864,55413,647000,41836,419358,931187,740255,460516,387552,110312,465668,527739,675774,17277,808492,651571,377899,131476,708014,676206,625442,493911,558955,123514,782444,774492,662739,432934,789165,503763,782813],[410763,920812,929057,202942,142907,325794,652271,876235,956257,800262,664363,138012,521774,759019,495596,155242,457738,956533,171003,401062,105062,228794,107989,541611,101274,70611,704220,730813,943533,345661,28899,502071,237542,754071,538286,752799,141575,424385],[774951,919312,433121,18203,190366,455114,652732,999926,478188,769662,177879,588448,420636,33859,520609,525223,568908,644420,778148,903878,310887,561349,325432,271641,14732,851638,91197,549303,886101,761761,728421,349966,28830,364584,224315,8625,219102,119681]]", 342938},
        };

        [Test]
        [TestCaseSource("testCasesStr")]
        public void Test_GenericStr(string heightsStr, int expected)
        {
            var heights = ArrayHelper.MatrixFromString<int>(heightsStr);

            var sol = new Solution();
            var res = sol.MinimumEffortPath(heights);

            Assert.That(expected == res);
        }
    }
}